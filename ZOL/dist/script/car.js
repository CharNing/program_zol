"use strict";function getcookie(){var e=$(".menu .buynum"),n=$(".car-state p span");if($.cookie("goodsid")&&$.cookie("goodsnum")){for(var t=$.cookie("goodsid").split(","),i=$.cookie("goodsnum").split(","),s=0;s<t.length;s++)render(t[s],i[s]);n.html(t.length),e.html(t.length)}changeNum(),del(),clear()}function render(e,t){var i=$(".order-table");$.ajax({type:"get",url:"http://10.31.155.61/program_zol/ZOL/php/details.php",dataType:"json",data:{id:e}}).done(function(e){var n='\n            <tr class = \'goodslist\'>\n                <td class="car-items">\n                    <input type="checkbox" class="choose" checked>\n                    <a href="#" class="pic" target="_blank">\n                        <img src="'+e.url+'">\n                    </a>\n                    <div class="inforbox">\n                        <h3 class="tit">\n                            <a href="#" title="'+e.headline+'">\n                            '+e.headline+'\n                            </a>\n                        </h3>\n                        <div class="clear_fix">\n                            <a href="#" title="7天退换货" class="security seven"></a>\n                        </div>\n                        <p>颜色：中文原包</p>\n                        <div class="info-con">\n                            <span>套装：官方标配</span>\n                            <div class="info-help">\n                                <h5>官方标配：</h5>\n                                <p>中文原包</p>\n                            </div>\n                        </div>\n                    </div>\n                </td>\n                <td class="car-price ">\n                    <em class="old-price">'+e.oldprice+"</em>\n                    <em class='new-price'>"+e.newprice+'</em>\n                </td>\n                <td class="count">\n                    <div class="buynum">\n                        <a href="javascript:;" class="minus">-</a>\n                        <input type="text" class="amount" value="'+t+'">\n                        <a href="javascript:;" class="add">+</a>\n                    </div>\n                </td>\n                <td class="discount">\n                    \x3c!-- <span class="tg">团购</span> --\x3e\n                    <p class="time">\n                        --\n                    </p>\n                </td>\n                <td>\n                    <em class="total-price">'+t*e.newprice+'</em>\n                </td>\n                <td class="del">\n                    <div class="delbox">\n                        <a href="javascript:;" title="移入收藏夹">移入收藏夹</a>\n                        <a href="javascript:;" class = \'remove\'>删除</a>\n                        \x3c!-- 点击删除按钮显示此提示 --\x3e\n                        <div class="deltip">\n                            <p>确认要删除该商品吗？</p>\n                            <a href="javascript:;" class=\'y\'>是的</a>\n                            <a href="javascript:;" class=\'n\'>取消</a>\n                            <i></i>\n                        </div>\n                    </div>\n                </td>\n            </tr>\n                ';i.children().append(n)}).done(function(){var e=$("#all"),n=$(".choose").not("#all");e.on("click",function(){$(this).prop("checked")?n.prop("checked",!0):n.prop("checked",!1)});var t=n.length;n.on("click",function(){$(".car-items input:checked").length===t?e.prop("checked",!0):e.prop("checked",!1)})})}function changeNum(){var e=$(".order-table"),a=null,c=null;e.delegate("a","click",function(e){var n=$.cookie("goodsnum").split(","),t=$(this).parents(".count").prev().children(".new-price").html(),i=$(this).parents(".count").siblings().children(".total-price"),s=$(e.target);s.hasClass("add")&&(a=$(this).prev().val(),c=n.indexOf(a),++a<99||(a=99),$(this).prev().val(a)),s.hasClass("minus")&&(a=$(this).next().val(),c=n.indexOf(a),0<--a||(a=1),$(this).next().val(a)),i.html(t*a),n[c]=a,$.cookie("goodsnum",n.toString(),{expires:30})})}function del(){$(".order-table").delegate("a","click",function(e){$(e.target).hasClass("remove")&&$(this).next().show(),$(".deltip").delegate("a","click",function(e){var n=$(e.target);if(n.hasClass("y")){var t=$(this).parents("tr").find($(".amount")).val(),i=$.cookie("goodsnum").split(","),s=i.indexOf(t),a=$.cookie("goodsid").split(",");i[s]="",i=i.filter(function(e){return""!==e}),a[s]="",a=a.filter(function(e){return""!==e}),$.cookie("goodsid",a.toString(),{expires:30}),$.cookie("goodsnum",i.toString(),{expires:30}),""==i&&($.cookie("goodsid","",{expires:-1}),$.cookie("goodsnum","",{expires:-1})),$(this).parents("tr").remove()}else n.hasClass("n")&&$(this).parent().hide()})})}function clear(){var e=$("#all");$(".delt").on("click",function(){e.prop("checked")?confirm("确认要清空购物车？")&&($.cookie("goodsid","",{expires:-1}),$.cookie("goodsnum","",{expires:-1}),$(".goodslist").remove(),$(".account").html(0),$(".car-state p span").html(0)):alert("请选中全部商品")})}require(["config"],function(){require(["jquery","jqcookie"],function(){getcookie()})});